---
import Layout from "../../layouts/Layout.astro";
import AdminNavbar from "../../components/admin/adminNavbar";
import "../../../assets/scss/astro-ecommerce.scss";
import UserTable from "../../components/admin/userTable";

const data = await fetch(
    "http://localhost:8080/api/v1/user/all?page=0&size=100"
);
const response = await data.json();
const result = response.result;
---

<!-- <script is:inline src="../../components/admin/crudUtils.tsx"></script> -->
<script>
    import { createUser, deleteUser } from "../../components/admin/crudUtils";

    // document.getElementById("createUserButton")?.addEventListener("click", createUser);

    Array.from(document.getElementsByClassName('deleteUser')).forEach(button => {
        button.addEventListener('click', () => {
            deleteUser(Number(button.id))
        })
    });
</script>

<Layout title="Manage user">
    <main>
        <AdminNavbar />
        <div class="container my-3">
            <div
                class="modal fade"
                id="createUserModal"
                role="dialog"
                aria-labelledby="createUserModalLabel"
                aria-hidden="true"
            >
                <div
                    class="modal-dialog modal-dialog-centered modal-xl"
                    role="form"
                >
                    <div class="modal-content">
                        <div class="card">
                            <div class="card-body d-block d-lg-flex p-4">
                                <form>
                                    <label for="name">Name</label>
                                    <input type="text" name="name" id="" />
                                    <label for="email">Email</label>
                                    <input type="text" name="email" id="" />
                                    <label for="phoneNumber">Phone number</label
                                    >
                                    <input
                                        type="text"
                                        name="phoneNumber"
                                        id=""
                                    />
                                    <label for="password">Password</label>
                                    <input type="text" name="password" id="" />
                                    <label for="role">Role</label>
                                    <input type="text" name="role" id="" />
                                    <button
                                        class="btn btn-light btn-md"
                                        data-bs-toggle="modal"
                                        data-bs-target="#createUserModal"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        class="btn btn-dark btn-md"
                                        id="submitCreateUser"
                                        type="submit"
                                    >
                                        Submit
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-9"></div>
                <div class="col-md-3">
                    <button
                        class="btn btn-dark btn-md"
                        data-bs-toggle="modal"
                        data-bs-target="#createUserModal"
                        id="createUserButton">Create user</button
                    >
                </div>
            </div>
            <div class="row">
                <div class="col">
                    {(<UserTable users={result.userList} />)}
                </div>
            </div>
        </div>
    </main>
</Layout>
